# Система управления школьной столовой

Полноценное веб-приложение с backend и базой данных для автоматизации работы школьной столовой.

## Технологии

### Frontend
- React 18
- React Router 6
- Vite

### Backend
- Node.js + Express
- SQLite (sql.js)
- JWT авторизация
- bcryptjs для хеширования паролей

## Быстрый старт

### 1. Установите зависимости

```bash
# Frontend
npm install

# Backend
cd server
npm install
cd ..
```

### 2. Инициализируйте базу данных

```bash
cd server
node seed.js
```

Это создаст базу данных с тестовыми данными.

### 3. Запустите backend сервер

```bash
cd server
npm run dev
```

Сервер запустится на **http://localhost:3000**

### 4. В новом терминале запустите frontend

```bash
npm run dev
```

Frontend запустится на **http://localhost:5174**

### 5. Откройте браузер

Перейдите на **http://localhost:5174** и войдите с тестовым аккаунтом.

## Тестовые аккаунты

- **Ученик**: `student@test.ru` / `123456`
- **Повар**: `cook@test.ru` / `123456`
- **Администратор**: `admin@test.ru` / `123456`

## API Endpoints

### Авторизация
- `POST /api/auth/register` - Регистрация
- `POST /api/auth/login` - Вход

### Меню
- `GET /api/menu` - Получить меню
- `POST /api/menu` - Добавить блюдо (админ)

### Оплата
- `POST /api/payments` - Создать платеж
- `GET /api/payments/history` - История платежей

### Заказы
- `GET /api/orders` - Получить заказы (повар/админ)
- `PATCH /api/orders/:id/complete` - Отметить как выданный

### Отзывы
- `POST /api/reviews` - Создать отзыв
- `GET /api/reviews/my` - Мои отзывы

### Остатки
- `GET /api/inventory` - Получить остатки (повар/админ)
- `PATCH /api/inventory/:id` - Обновить количество

### Заявки на закупку
- `GET /api/requests` - Получить заявки
- `POST /api/requests` - Создать заявку (повар)
- `PATCH /api/requests/:id` - Обновить статус (админ)

### Статистика
- `GET /api/stats` - Получить статистику (админ)

## Структура проекта

```
├── src/                    # Frontend
│   ├── api/
│   │   └── client.js      # API клиент
│   ├── components/
│   │   └── Sidebar.jsx    # Боковое меню
│   ├── pages/
│   │   ├── Login.jsx      # Авторизация
│   │   ├── Register.jsx   # Регистрация
│   │   ├── Student/       # Модуль ученика
│   │   ├── Cook/          # Модуль повара
│   │   └── Admin/         # Модуль администратора
│   └── styles/            # CSS стили
├── server/                # Backend
│   ├── routes/           # API роуты
│   ├── middleware/       # Middleware (auth)
│   ├── database.js       # Работа с БД
│   ├── seed.js          # Тестовые данные
│   └── server.js        # Главный файл сервера
└── canteen.db           # База данных SQLite
```

## Реализованная функциональность

### ✅ Для учеников
- Регистрация и авторизация
- Просмотр меню с аллергенами
- Оплата питания (разово/абонемент)
- Указание аллергенов и предпочтений
- Отзывы о блюдах

### ✅ Для поваров
- Авторизация
- Учет выданных блюд
- Контроль остатков продуктов
- Создание заявок на закупку

### ✅ Для администраторов
- Авторизация
- Статистика оплат и посещаемости
- Согласование заявок на закупку
- Формирование отчетов

## Безопасность

- Пароли хешируются с помощью bcryptjs
- JWT токены для авторизации
- Проверка ролей на backend
- CORS настроен для безопасности

## Разработка

### Добавление новых функций

1. Создайте новый роут в `server/routes/`
2. Добавьте метод в `src/api/client.js`
3. Создайте компонент в соответствующей папке
4. Добавьте роут в Dashboard компонент

### База данных

База данных SQLite хранится в файле `canteen.db`. Для сброса данных:

```bash
cd server
rm canteen.db
node seed.js
```

## Производство

Для деплоя:

1. Соберите frontend:
```bash
npm run build
```

2. Настройте переменные окружения в `server/.env`
3. Запустите сервер:
```bash
cd server
npm start
```

## Лицензия

MIT
