# üîí HTTPS –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ - –ü–æ–ª–Ω—ã–π –°–ø–∏—Å–æ–∫ –ò–∑–º–µ–Ω–µ–Ω–∏–π

## üìã –ò–∑–º–µ–Ω–µ–Ω–Ω—ã–µ –§–∞–π–ª—ã

### 1. server/index.js
**–ß—Ç–æ –∏–∑–º–µ–Ω–µ–Ω–æ:**
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω—ã –∏–º–ø–æ—Ä—Ç—ã `https` –∏ `fs`
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω—ã –∫–æ–Ω—Å—Ç–∞–Ω—Ç—ã `HTTP_PORT` –∏ `HTTPS_PORT`
- ‚úÖ –°–æ–∑–¥–∞–Ω—ã `sslOptions` —Å –ø—É—Ç—è–º–∏ –∫ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–∞–º
- ‚úÖ CORS –Ω–∞—Å—Ç—Ä–æ–µ–Ω –Ω–∞ HTTPS –¥–æ–º–µ–Ω
- ‚úÖ Session cookies –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã –Ω–∞ secure: true
- ‚úÖ –°–æ–∑–¥–∞–Ω HTTPS —Å–µ—Ä–≤–µ—Ä –Ω–∞ –ø–æ—Ä—Ç—É 443
- ‚úÖ –°–æ–∑–¥–∞–Ω HTTP —Å–µ—Ä–≤–µ—Ä –Ω–∞ –ø–æ—Ä—Ç—É 80 –¥–ª—è —Ä–µ–¥–∏—Ä–µ–∫—Ç–∞
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω–∞ –ª–æ–≥–∏–∫–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ —Ä–µ–¥–∏—Ä–µ–∫—Ç–∞ HTTP ‚Üí HTTPS

**–ö–æ–¥ –∏–∑–º–µ–Ω–µ–Ω–∏–π:**
```javascript
// –ò–º–ø–æ—Ä—Ç—ã
import https from 'https'
import fs from 'fs'

// SSL —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç—ã
const sslOptions = {
  key: fs.readFileSync(path.join(__dirname, '..', 'cert', 'key.txt')),
  cert: fs.readFileSync(path.join(__dirname, '..', 'cert', 'www_autogreatfood_ru_2026_08_30.crt'))
}

// HTTPS —Å–µ—Ä–≤–µ—Ä
https.createServer(sslOptions, app).listen(HTTPS_PORT, '0.0.0.0', ...)

// HTTP —Ä–µ–¥–∏—Ä–µ–∫—Ç
if (process.env.ENABLE_HTTP_REDIRECT === 'true') {
  const httpApp = express()
  httpApp.use('*', (req, res) => {
    res.redirect(301, `https://${req.headers.host}${req.url}`)
  })
  httpApp.listen(HTTP_PORT, '0.0.0.0', ...)
}
```

### 2. .env
**–ß—Ç–æ –∏–∑–º–µ–Ω–µ–Ω–æ:**
- ‚úÖ NODE_ENV=production (–±—ã–ª–æ: development)
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω HTTPS_PORT=443
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω HTTP_PORT=80
- ‚úÖ FRONTEND_URL=https://www.autogreatfood.ru (–±—ã–ª–æ: http://localhost:3000)
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω ENABLE_HTTP_REDIRECT=true

**–ù–æ–≤—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ:**
```env
NODE_ENV=production
HTTP_PORT=80
HTTPS_PORT=443
FRONTEND_URL=https://www.autogreatfood.ru
ENABLE_HTTP_REDIRECT=true
```

### 3. package.json
**–ß—Ç–æ –∏–∑–º–µ–Ω–µ–Ω–æ:**
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω —Å–∫—Ä–∏–ø—Ç `"start:https": "node server/index.js"`

## üìÅ –ù–æ–≤—ã–µ –§–∞–π–ª—ã

### –°–∫—Ä–∏–ø—Ç—ã –ó–∞–ø—É—Å–∫–∞
1. **start-https.bat**
   - –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–∞–≤ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞
   - –ó–∞–ø—É—Å–∫ HTTPS —Å–µ—Ä–≤–µ—Ä–∞
   - –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –ø–æ–¥—Å–∫–∞–∑–∫–∏

2. **docker-start-https.bat**
   - –ó–∞–ø—É—Å–∫ Docker —Å HTTPS
   - –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è —Å–±–æ—Ä–∫–∞ –∏ —Å—Ç–∞—Ä—Ç
   - –ü–æ–∫–∞–∑ —Å—Ç–∞—Ç—É—Å–∞ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤

### Docker –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
3. **docker-compose.https.yml**
   - –ù–∞—Å—Ç—Ä–æ–µ–Ω–Ω—ã–π –¥–ª—è HTTPS
   - –ú–æ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–∞–ø–∫–∏ cert/
   - –ü–æ—Ä—Ç—ã 80 –∏ 443
   - –í—Å–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è

### –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
4. **HTTPS_–ó–ê–ü–£–°–ö.md**
   - –ü–æ–¥—Ä–æ–±–Ω–∞—è –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –ø–æ –∑–∞–ø—É—Å–∫—É
   - –í—Å–µ —Å–ø–æ—Å–æ–±—ã –∑–∞–ø—É—Å–∫–∞
   - –†–µ—à–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º
   - –ù–∞—Å—Ç—Ä–æ–π–∫–∞ DNS –∏ Firewall

5. **–ë–´–°–¢–†–´–ô_–°–¢–ê–†–¢_HTTPS.txt**
   - –ö—Ä–∞—Ç–∫–∞—è –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è
   - –û—Å–Ω–æ–≤–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã
   - –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

6. **HTTPS_–ì–û–¢–û–í–û.md**
   - –ü–æ–ª–Ω–∞—è —Å–≤–æ–¥–∫–∞ –∏–∑–º–µ–Ω–µ–Ω–∏–π
   - –ß—Ç–æ —Å–¥–µ–ª–∞–Ω–æ
   - –ö–∞–∫ –∑–∞–ø—É—Å—Ç–∏—Ç—å
   - –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç—ã

7. **–ù–ê–ß–ù–ò–¢–ï_–ó–î–ï–°–¨_HTTPS.txt**
   - –°—Ç–∞—Ä—Ç–æ–≤–∞—è —Ç–æ—á–∫–∞
   - –ü–æ—à–∞–≥–æ–≤–∞—è –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è
   - –ö—Ä–∞—Å–∏–≤–æ–µ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

8. **HTTPS_–ò–ó–ú–ï–ù–ï–ù–ò–Ø.md** (—ç—Ç–æ—Ç —Ñ–∞–π–ª)
   - –°–ø–∏—Å–æ–∫ –≤—Å–µ—Ö –∏–∑–º–µ–Ω–µ–Ω–∏–π
   - –î–µ—Ç–∞–ª–∏ –º–æ–¥–∏—Ñ–∏–∫–∞—Ü–∏–π

## üîê –ò—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ –°–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç—ã

### –§–∞–π–ª—ã –≤ –ø–∞–ø–∫–µ cert/
- **key.txt** (1707 –±–∞–π—Ç)
  - –ü—Ä–∏–≤–∞—Ç–Ω—ã–π –∫–ª—é—á RSA
  - –§–æ—Ä–º–∞—Ç: PEM

- **www_autogreatfood_ru_2026_08_30.crt** (2277 –±–∞–π—Ç)
  - SSL —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç –æ—Ç GlobalSign
  - –î–æ–º–µ–Ω—ã: www.autogreatfood.ru, autogreatfood.ru
  - –°—Ä–æ–∫ –¥–µ–π—Å—Ç–≤–∏—è: –¥–æ 30.08.2026

## üîß –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –î–µ—Ç–∞–ª–∏

### –ü–æ—Ä—Ç—ã
- **443** - HTTPS (–∑–∞—â–∏—â–µ–Ω–Ω–æ–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ)
- **80** - HTTP (—Ä–µ–¥–∏—Ä–µ–∫—Ç –Ω–∞ HTTPS)

### –ü—Ä–æ—Ç–æ–∫–æ–ª—ã
- **HTTPS** - –æ—Å–Ω–æ–≤–Ω–æ–π –ø—Ä–æ—Ç–æ–∫–æ–ª
- **TLS** - —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ
- **HTTP/1.1** - –±–∞–∑–æ–≤—ã–π –ø—Ä–æ—Ç–æ–∫–æ–ª

### –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å
- ‚úÖ Secure cookies
- ‚úÖ HTTPS only
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π —Ä–µ–¥–∏—Ä–µ–∫—Ç
- ‚úÖ CORS –Ω–∞—Å—Ç—Ä–æ–µ–Ω –ø—Ä–∞–≤–∏–ª—å–Ω–æ
- ‚úÖ Session security

## üìä –°—Ä–∞–≤–Ω–µ–Ω–∏–µ –î–æ/–ü–æ—Å–ª–µ

### –î–æ (HTTP)
```
–ü–æ—Ä—Ç: 80
–ü—Ä–æ—Ç–æ–∫–æ–ª: HTTP
URL: http://localhost:80
–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å: ‚ùå –ù–µ—Ç —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è
Cookies: secure: false
```

### –ü–æ—Å–ª–µ (HTTPS)
```
–ü–æ—Ä—Ç—ã: 80 (—Ä–µ–¥–∏—Ä–µ–∫—Ç) + 443 (HTTPS)
–ü—Ä–æ—Ç–æ–∫–æ–ª: HTTPS
URL: https://www.autogreatfood.ru
–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å: ‚úÖ TLS —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ
Cookies: secure: true
–†–µ–¥–∏—Ä–µ–∫—Ç: HTTP ‚Üí HTTPS
```

## üöÄ –°–ø–æ—Å–æ–±—ã –ó–∞–ø—É—Å–∫–∞

### 1. –õ–æ–∫–∞–ª—å–Ω—ã–π –∑–∞–ø—É—Å–∫
```bash
# –ß–µ—Ä–µ–∑ BAT —Ñ–∞–π–ª
start-https.bat (–æ—Ç –∏–º–µ–Ω–∏ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞)

# –ß–µ—Ä–µ–∑ NPM
npm start

# –ß–µ—Ä–µ–∑ Node
node server/index.js
```

### 2. Docker –∑–∞–ø—É—Å–∫
```bash
# –ß–µ—Ä–µ–∑ BAT —Ñ–∞–π–ª
docker-start-https.bat

# –ß–µ—Ä–µ–∑ docker-compose
docker-compose -f docker-compose.https.yml up -d --build
```

## ‚úÖ –ß–µ–∫–ª–∏—Å—Ç –ì–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏

- [x] –°–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç—ã –≤ –ø–∞–ø–∫–µ cert/
- [x] server/index.js –æ–±–Ω–æ–≤–ª–µ–Ω
- [x] .env –Ω–∞—Å—Ç—Ä–æ–µ–Ω
- [x] package.json –æ–±–Ω–æ–≤–ª–µ–Ω
- [x] –°–∫—Ä–∏–ø—Ç—ã –∑–∞–ø—É—Å–∫–∞ —Å–æ–∑–¥–∞–Ω—ã
- [x] Docker –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è —Å–æ–∑–¥–∞–Ω–∞
- [x] –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –Ω–∞–ø–∏—Å–∞–Ω–∞
- [x] –ö–æ–¥ –ø—Ä–æ–≤–µ—Ä–µ–Ω (–±–µ–∑ –æ—à–∏–±–æ–∫)

## üéØ –°–ª–µ–¥—É—é—â–∏–µ –®–∞–≥–∏

1. **–ó–∞–ø—É—Å—Ç–∏—Ç—å —Å–µ—Ä–≤–µ—Ä**
   ```bash
   start-https.bat (–æ—Ç –∏–º–µ–Ω–∏ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞)
   ```

2. **–ü—Ä–æ–≤–µ—Ä–∏—Ç—å –≤ –±—Ä–∞—É–∑–µ—Ä–µ**
   - –û—Ç–∫—Ä—ã—Ç—å https://www.autogreatfood.ru
   - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∑–∞–º–æ—á–µ–∫ üîí

3. **–ù–∞—Å—Ç—Ä–æ–∏—Ç—å DNS** (–µ—Å–ª–∏ –Ω—É–∂–Ω–æ)
   - autogreatfood.ru ‚Üí IP —Å–µ—Ä–≤–µ—Ä–∞
   - www.autogreatfood.ru ‚Üí IP —Å–µ—Ä–≤–µ—Ä–∞

4. **–û—Ç–∫—Ä—ã—Ç—å –ø–æ—Ä—Ç—ã –≤ Firewall**
   ```powershell
   netsh advfirewall firewall add rule name="HTTPS" dir=in action=allow protocol=TCP localport=443
   netsh advfirewall firewall add rule name="HTTP" dir=in action=allow protocol=TCP localport=80
   ```

## üìû –ü–æ–¥–¥–µ—Ä–∂–∫–∞

### –ü—Ä–æ–±–ª–µ–º—ã —Å –∑–∞–ø—É—Å–∫–æ–º?
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø—Ä–∞–≤–∞ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ –ø–æ—Ä—Ç—ã 80 –∏ 443 —Å–≤–æ–±–æ–¥–Ω—ã
- –°–º–æ—Ç—Ä–∏—Ç–µ –ª–æ–≥–∏: `docker-compose -f docker-compose.https.yml logs -f`

### –ü—Ä–æ–±–ª–µ–º—ã —Å —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–æ–º?
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ñ–∞–π–ª—ã –≤ –ø–∞–ø–∫–µ cert/
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –¥–æ–º–µ–Ω –≤ –∞–¥—Ä–µ—Å–Ω–æ–π —Å—Ç—Ä–æ–∫–µ
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å—Ä–æ–∫ –¥–µ–π—Å—Ç–≤–∏—è —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–∞

### –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
- **–ü–æ–¥—Ä–æ–±–Ω–∞—è:** HTTPS_–ó–ê–ü–£–°–ö.md
- **–ö—Ä–∞—Ç–∫–∞—è:** –ë–´–°–¢–†–´–ô_–°–¢–ê–†–¢_HTTPS.txt
- **–°—Ç–∞—Ä—Ç–æ–≤–∞—è:** –ù–ê–ß–ù–ò–¢–ï_–ó–î–ï–°–¨_HTTPS.txt

## üéâ –ì–æ—Ç–æ–≤–æ!

–í—Å–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –ø—Ä–∏–º–µ–Ω–µ–Ω—ã, HTTPS –Ω–∞—Å—Ç—Ä–æ–µ–Ω –∏ –≥–æ—Ç–æ–≤ –∫ —Ä–∞–±–æ—Ç–µ!

**–î–æ–º–µ–Ω:** www.autogreatfood.ru  
**–°–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç:** GlobalSign (–¥–æ 30.08.2026)  
**–°—Ç–∞—Ç—É—Å:** ‚úÖ –ì–æ—Ç–æ–≤–æ –∫ –∑–∞–ø—É—Å–∫—É
